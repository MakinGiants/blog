---
title: How to call a webservice using ksoap
layout: post
date: 2012-11-09 21:37:00 UTC
updated: 2015-02-08 19:42:32 UTC
comments: false
categories: Android
---
<br /><ul><li>Include&nbsp;<a href="http://code.google.com/p/ksoap2-android/">Ksoap for android</a>&nbsp;in the project or&nbsp;<a href="https://docs.google.com/open?id=0B3x-SVLhe4jubkdPb1hXMHVmX28">Download here</a></li></ul><ul><li>Code to call the webservice:</li></ul><div class="p3"><span class="Apple-tab-span"> </span><span class="Apple-tab-span"> </span></div><div class="p3"><span class="Apple-tab-span"> </span><span class="Apple-tab-span"> </span></div><div class="p3"><span class="Apple-tab-span"> </span></div><div class="p3"><span class="Apple-tab-span"> </span></div><div class="p3"><span class="Apple-tab-span"> </span><span class="Apple-tab-span"> </span></div><div class="p3"><span class="Apple-tab-span"> </span><span class="Apple-tab-span"> </span></div><div class="p3"><span class="Apple-tab-span"> </span><span class="Apple-tab-span"> </span></div><div class="p3"><span class="Apple-tab-span"> </span><span class="Apple-tab-span"> </span></div><div class="p3"><span class="Apple-tab-span"> </span><span class="Apple-tab-span"> </span></div><div class="p3"><span class="Apple-tab-span"> </span><span class="Apple-tab-span"> </span></div><div class="p3"><span class="Apple-tab-span"> </span><span class="Apple-tab-span"> </span></div><div class="p3"><span class="Apple-tab-span"> </span><span class="Apple-tab-span"> </span><span class="Apple-tab-span"> </span></div><div class="p3"><span class="Apple-tab-span"> </span><span class="Apple-tab-span"> </span><span class="Apple-tab-span"> </span></div><div class="p3"><span class="Apple-tab-span"> </span><span class="Apple-tab-span"> </span><span class="Apple-tab-span"> </span></div><div class="p3"><span class="Apple-tab-span"> </span><span class="Apple-tab-span"> </span></div><div class="p3"><span class="Apple-tab-span"> </span><span class="Apple-tab-span"> </span></div><pre style="background-image: URL(http://2.bp.blogspot.com/_z5ltvMQPaa8/SjJXr_U2YBI/AAAAAAAAAAM/46OqEP32CJ8/s320/codebg.gif); background: #f0f0f0; border: 1px dashed #CCCCCC; color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;">   public static String loadMethod() throws IOException, XmlPullParserException {  <br />   // WebService properties  <br />   final String namespace = "http://namespace.com";  <br />   final String methodName = "getSomething";   <br />   final String soapAction = "http://namespace.com/getSomething";   <br />   final String url = "http://namespace.com/getSomething";   <br />   return callWebService(namespace, methodName, soapAction, url, null);   <br />   }&nbsp;</code></pre><pre style="background: none repeat scroll 0% 0% rgb(240, 240, 240); border: 1px dashed rgb(204, 204, 204); color: black; font-family: arial; font-size: 12px; height: auto; line-height: 20px; overflow: auto; padding: 0px; text-align: left; width: 99%;"><code style="color: black; word-wrap: normal;">  <span style="color: red;"> /**  <br />   *  <br />   * Call a web service and return the response  <br />   *  <br />   * @param namespace  <br />   * @param methodName  <br />   * @param soapAction  <br />   * @param url  <br />   * @param arrayProperties  <br />   *      attributes of the web service (method parameters)  <br />   * @return xml String with the response  <br />   * @throws IOException  <br />   * @throws XmlPullParserException  <br />   */  <br />   public static String callWebService(final String namespace, final String methodName, final String soapAction,  <br />   final String url, final PropertyInfo[] arrayProperties) throws IOException, XmlPullParserException {  <br />   SoapPrimitive resultsRequestSOAP = null;  <br />   // Se crea un objeto SoapObject para poder realizar la peticion// para consumir el ws SOAP. El constructor recibe// el namespace. Por lo regular el namespace es el dominio// donde se encuentra el web service  <br />   final SoapObject request = new SoapObject(namespace, methodName);  <br />   if (arrayProperties != null) {for (final PropertyInfo propertyInfo : arrayProperties) {request.addProperty(propertyInfo);}  <br />   }  <br />   // Se crea un objeto SoapSerializationEnvelope para serealizar la// peticion SOAP y permitir viajar el mensaje por la nube// el constructor recibe la version de SOAP  <br />   final SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);  <br />   envelope.dotNet = true; // se asigna true para el caso de que el WS sea de doNet<br /><br />   // Se envuelve la peticion soap  <br />   envelope.setOutputSoapObject(request);  <br />   // Objeto que representa el modelo de transporte// Recibe la URL del wsfinal HttpTransportSE transporte = new HttpTransportSE(url);  <br />   try {  <br />   transporte.debug = true;// Hace la llamada al wstransporte.call(soapAction, envelope);// Se crea un objeto SoapPrimitive y se obtiene la respuesta// de la peticionresultsRequestSOAP = (SoapPrimitive) envelope.getResponse();  <br />   }  <br />   catch (final IOException e) {  <br />   throw e;}  <br />   catch (final XmlPullParserException e) {  <br />   throw e;}  <br />   // Almacenamos el resultado en un String ya que lo que represa  <br />   // el ws es una cadena json, representando una lista AndroidOS  <br />   // de objetos del tipo  <br />   return resultsRequestSOAP.toString();   <br />   }  </span><br /></code></pre>